WAL_DIRECTORY="/pgdata/12/pg_wal"
cd "${WAL_DIRECTORY}"

# Find all the files in the WAL Directory.
# Sort them in reverse order (highest hex value at the top)
# Just get the file at the top 
WAL_FILE=$(find . -maxdepth 1 -type f \
    | sort --reverse \
    | head -n 1)
    
echo "WAL_FILE=${WAL_FILE}"

ARCHIVE_DIRECTORY="/pgwal_archive/{peekStandbyServer.hostname}"
cd "${ARCHIVE_DIRECTORY}"

if [ -f "${WAL_FILE}" ]
then
    echo "WAL file ${WAL_FILE} not exists in Archive Directory"
    # It's non critical if the WAL file exists.
    # 
    # This is to notify the user that the restore_archive
    # command doesn't delete the WAL file on the standby's 
    # Shipping Directory.
    exit 1
else
    echo "WAL file ${WAL_FILE} does not exist in Archive Directory"
fi