BACKUP_DIRECTORY="postgresqlBaseBackup"
mkdir -p "${BACKUP_DIRECTORY}"
cd "${BACKUP_DIRECTORY}"

if [ -z "$(ls -A)" ]
then
    echo "${BACKUP_DIRECTORY} is Empty"
else
    echo "${BACKUP_DIRECTORY} is not Empty, deleting it's contents."
    rm -v *
fi

echo "Putting backup in ${BACKUP_DIRECTORY}"

pg_basebackup --pgdata=./ \
    --format=t \
    --gzip \
    --wal-method=fetch \
    --progress